## 堆和栈的区别
### 定义
```
1、堆栈是两种数据结构。堆栈都是一种数据项按序排列的数据结构，只能在一端对数据进行插入和删除。

2、堆，队列优先，先进先出（FIFO）；栈，先进后出（FILO）
```
### 区别
- **空间分配**

`栈`由操作系统自动分配释放，存放函数的参数值、局部变量的值等。其操作方式类似于数据结构中的栈。

`堆`一般有程序员分配释放，若程序员不释放，程序结束时可能由OS回收，分配方式类似于链表

- **缓存方式**

`栈`使用的是一级缓存，他们通常都是在被调用时处于存储空间中，调用完毕立即释放。

`堆`存放在二级缓存中，生命周期由虚拟机的垃圾回收算法来决定（并不是一旦成为孤儿对象就能被回收）

- **数据结构**

`栈`一种先进后出的数据结构

`堆`可以被看成是一棵树。eg：堆排序

- **产生碎片**

`栈`不会有堆产生碎片的问题，因为栈是先进后出的队列，不可能有一个内存块从栈的中间弹出，弹出之前，后进的内容就已经被弹出。

`堆`会频繁的new/delete会造成内存空间的不连续，从而造成大量的碎片，使程序的效率降低。

- **生长方式**

`栈`的生长方向是向下的，是向着内存地址减小的方向增长。

`堆`的生长方向是向上的，即向着内存地址增长的方向。

- **分配效率**

`栈`是机器系统提供的数据结构，计算机会在底层对栈提供支持：分配专门的寄存器放栈的地址，压栈出栈都有专门的指令执行，所以效率高。

`堆`则是C/C++函数提供的，它的机制较为复杂。效率较低，原因如下：
```
1、例如为了分配一块内存，库函数会按照一定的算法（具体的算法可以参考数据结构/操作系统）在堆内 存中搜索可用的足够大小的空间。

2、如果没有足够大小的空间（可能是由于内存碎片太多），就有可能调用系统功能去增加程序数据段的内存空间，这样就有机会分到 足够大小的内存，然后进行返回。
```

- **分配方式**

`栈`有两种分配方式：静态分配和动态分配，如下：
```
静态分配：是编译器完成的，比如局部变量的分配。

动态分配：有alloc函数进行分配，但是栈的动态分配和堆是不同的，他的动态分配是编译器进行释放，无需手动释放。
```
