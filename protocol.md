### TCP/IP、UDP、Socket、HTTP、FTP
[参考文档1](https://blog.csdn.net/tiancheng1016/article/details/52582988)

[参考文档2](https://blog.csdn.net/hai_chao/article/details/79626161)

~~[协议简析](#协议简析)~~

~~[Socket连接与HTTP连接区别](#Socket连接与HTTP连接区别)~~

~~[TCP与UDP](#TCP与UDP)~~

- **协议简析**

```
TCP/IP是一个协议组（主要解决数据在网络中如何传输），可以分为三个层次：网络层、传输层、协议层
```
```
网络层：IP协议、ICMP协议、ARP协议、RARP协议和BOOTP协议

传输层：TCP协议、UDP协议

应用层：FTP、HTTP、TELNET、SMTP、DNS等协议
```
- **Socket连接与HTTP连接区别**

>Socket

```
1、 通常情况下Socket连接就是TCP连接，因此Socket连接一旦建立，通信双方即可开始项目发送数据，直到双方连接断开。

2、 理论上客户端与服务端一旦建立连接将不会主动断掉。

3、 客户端到服务器之间的通信往往穿越多个中间节点，如路由器、网关、防火墙、可能会使其断开，大部分防火墙默认会关闭长时间处于非活跃状态的连接而导致Socket连接断开，因此需要通过轮询告诉网络（发送心跳消息），使该连接处于活跃状态。
```
>Http
>>http协议是建立在请求/响应的模型上。

```
1、HTTP协议是建立在TCP协议之上的一种应用，HTTP连接使用的是“请求 - 响应”的方式，不仅在请求时需要建立连接，而且需要客户端发送请求后，服务端才能回复数据。

2、请求结束后，会主动释放连接。从建立连接到关闭连接的过程称为“一次连接”。

3、如果需要保持长连接，需要发送心跳包；若服务器长时间无法接受到客户端的请求，则认为客户端 “下线”，若客户端长时间无法接受到服务器的回复，则认为网络已经断开。

4、目前基于http协议传输的主要有http协议和基于http协议的Soap协议（web service）；常见方式http的post/get请求，web服务。
```
>适用情况

```
场景1：很多情况下，需要服务器主动向客户端推送数据，保持客户端与服务器的实时和同步。此时若双方建立的是Socket连接，服务器就可以直接将数据传输给客户端。

Socket传输特点：Socket传输方式适用于对传输速度，安全性、实时交互、费用等要求高的应用中，如网络游戏、手机应用、银行内部交互等

场景2：若双方建立的是HTTP连接，则服务器需要等到客户端发送一次请求后，才能将数据传回客户端，因此，客户端定时想服务器端发送请求，不仅可以保持在线，同时也是在“询问”服务器是否有新的数据，如果有就将数据返回。

HTTP传输特点：基于http协议传输方式适合于对传输速度、安全性要求不高，且需要快速开发的应用。如公司OA系统、互联网服务等。

```
>Socket原理

>>- `套接字(Socket)概念`
```
1、套接字（Socket）是通信的基石，是支持TCP/IP协议的网络通信的基本操作单元。
2、它是网络通信过程中端点的抽象表示，包含进行网络通信必须的五种信息：a、连接使用的协议 b、本地主机的地址 c、本地进程的协议端口 d、远程主机的IP地址 e、远地进程的协议端口
```
>>- `建立Socket连接`
```
1、建立Socket连接至少需要一对套接字，其中一个运行在客户端称为ClientSocket，另一个运行于服务端，称为ServerSocket。
2、套接字之间的连接过程分为三个步骤：服务器监听、客户端请求、连接确认
服务器监听：服务器端套接字并不定位具体的客户端套接字，而是出于等待连接的状态，实时监控网络状态，等待客户端的连接请求
客户端请求：指客户端的套接字提出连接请求，要连接的目标是服务器端的套接字，为此，客户端的套接字必须首先描述它要连接的服务器的套接字，指出服务器端套接字的地址和端口号，然后就向服务器端套接字提出连接申请。
连接确认：当服务器端套接字监听到或者说接收到客户端套接字的连接请求时，就响应客户端套接字的请求，建立一个新的线程，包服务器端套接字的描述发给客户端，一旦客户端确认了此描述，双方就正式建立连接。而服务端套接字继续处于监听状态 ，继续监听其他客户端套接字的连接请求。
```
>>- `Socket连接与TCP连接`
```
1、创建Socket连接时，可以指定使用的传输层协议，Socket可以支持不同的传输层协议（TCP或UDP）。
2、当使用TCP协议进行连接时，该Socket连接是一个TCP连接。
```

<br/>

> 传输特点
>>- `Socket传输的特点`
```
优点：
1、传输数据为字节级，传输输入可以自定义，数据量小（对于手机应用讲：费用低）
2、传输数据时间短，性能高。
3、适合于客户端和服务器端之间信息实时交互。
4、可以加密，数据安全性强。
缺点：
1、需对传输数据进行解析，转换为应用级的数据。
2、对开发人员的开发水平要求高
3、相对于Http协议传输，增加了并发量。
```
>>- Http协议的传输特点
```
优点：
1、基于应用级的接口使用方便。
2、程序员开发水平要求不高，容错性强。
缺点：
1、传输速度慢，数据包大。
2、如实时交互，服务器性能压力大。
3、数据传输安全性能差。
```

- **TCP与UDP**

> 概念
>>- TCP
```
1、传输控制协议，提供的是面向连接，给用户进程提供可靠的全双工的字节流服务。
2、当客户和服务器彼此交换数据前，必须现在双方之间建立一个TCP连接，知乎才能进行传输数据。
3、TCP提供超时重发，丢弃重复数据，检验数据，流量控制等功能，保证数据能从一端传到另一端
4、理想状态下，TCP连接一旦建立，在通信双方中的任何一方主动关闭连接前，TCP连接都将被一直保持下去。
5、断开连接时，服务器和客户端均可以主动发起断开TCP连接的请求。
```
>>- UDP
```
1、用户数据报协议，是一个无连接的简单的面向数据报的运输层协议（即广播式数据传输，不进行数据验证，不是面向连接的协议）
2、UDP不提供可靠性，它只是把应用程序传给IP层的数据报发送出去，但是并不能保证他们能到达目的地。
3、由于UDP在传输数据报钱不用再客户和服务器之间建立一个连接，且没有超时重发等机制，故而传输速度快。
```

> 适用情况
>>- TCP
```
1、TCP发送的包有序号，对方收到包后要给一个反馈，如果超过一定时间还没有收到反馈就自动执行超时重发，因此TCP最大的优点是可靠。
2、一般网页（http）、邮件（SMTP）、远程连接（Telnet）、文件（FTP）传送就用TCP
```
>>- UDP
```
1、UDP是面向消息的协议，通信时不需要建立连接，数据的传输自然是不可靠的。
2、多用于多点通信和实时的数据业务：语音广播、视频、QQ、TFTP（单文件传送）、
```

> [TCP连接的三次握手](https://www.cnblogs.com/zhuwq585/p/6138775.html)
>>- 三次握手
```
1、客户端的应用进程主动打开，并向客户端发出请求报文段。其首部中：SYN=1,seq=x。
2、服务器应用进程被动打开。若同意客户端的请求，则发回确认报文，其首部中：SYN=1,ACK=1,ack=x+1,seq=y
3、客户端收到确认报文之后，通知上层应用进程连接已建立，并向服务器发出确认报文，其首部：ACK=1,ack=y+1。当服务器收到客户端的确认报文之后，也通知其上层应用进程连接已建立。
```
>>- 四次挥手
```
1、数据传输结束以后，客户端的应用进程发出连接释放报文段，并停止发送数据，其首部：FIN=1,seq=u。
2、服务器端收到连接释放报文段之后，发出确认报文，其首部：ack=u+1,seq=v。此时本次连接就进入了半关闭状态，客户端不再向服务器发送数据。而服务器端仍会继续发送。
3、若服务器已经没有要向客户端发送的数据，其应用进程就通知服务器释放TCP连接。这个阶段服务器所发出的最后一个报文的首部应为：FIN=1,ACK=1,seq=w,ack=u+1。
4、客户端收到连接释放报文段之后，必须发出确认：ACK=1,seq=u+1,ack=w+1。 再经过2MSL(最长报文端寿命)后，本次TCP连接真正结束，通信双方完成了他们的告别。
```
